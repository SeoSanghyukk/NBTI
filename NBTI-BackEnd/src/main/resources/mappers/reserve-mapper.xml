<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  <mapper namespace="Reserve">
  	<insert id="insert">
  		INSERT 
  		INTO 
  			reserve VALUES (reserve_seq.nextval, #{member_id},#{reserve_title_code} ,#{purpose},#{start_time}, #{end_time} , 'N')
  	</insert>
  	
  	<select id="waitingList" resultType="com.nbti.dto.ReserveDTO">
		SELECT 
		    r.seq AS reservation_seq,
		    r.member_id,
		    CASE 
		        WHEN r.reserve_title_code = '1' THEN '회의실'
		        WHEN r.reserve_title_code = '2' THEN '비품'
		        WHEN r.reserve_title_code = '3' THEN '차량'
		        ELSE '기타' 
		    END AS reserve_title_code,
		    r.purpose,
		    r.start_time,
		    r.end_time,
		    r.state
		FROM 
		    reserve r
		WHERE 
		    r.state = 'N'
		ORDER BY 
		    r.start_time
  	</select>
  </mapper>